\startfirstchapter{Introduction} \label{ch:1}
\section{Background and Motivation}
A surface is what forms a common boundary between two phases of matter. The phases of matter can be of any forms, i.e, solid, liquid, and gas. The behavior of a surface greatly affects the properties of a material, such as oxidation, corrosion, chemical activity, deformation and fracture, surface energy and tension, adhesion, bonding, friction, lubrication, wear and contamination. Therefore, surface characterization identification remains an active area of research in the physics, chemistry, and biotechnology communities as well as in modern electronic technology. It also plays a crucial role in surface science. Among various surface properties, molecular orientation is a key factor of all, because molecular orientation greatly affects molecules' surface properties in aspects such as: adhesion, lubrication, catalysis, bio-membrane functions and so on. \cite{PhysRevB.59.12632}\\

Many experimental techniques have been applied in the study of molecular orientation at surfaces. Among them the optical methods are more preferable. Such methods include infrared (IR) absorption, Raman scattering and visible-infrared sum-frequency generation (SFG) spectroscopies. All these vibrational spectra carry quantitative structural information of molecules at surfaces. Although each of them has its own strengths and shortcomings, they all share the following advantages when compared with other non-optical methods. First of all, they all can be applied to any surfaces accessible by light. Second, they are non-destructive. Third, they offer good spatial, temporal and spectral resolutions \cite{Brasselet:11},\cite{PhysRevB.59.12632}. An important advantage of SFG techniques is that it can discriminate against bulk contributions. This means that its result will not take the effect from the bulk. In order to extract the quantitative structural information that molecules carry at surfaces, different spectroscopy techniques and analysis are required. Combining different spectroscopy techniques is a very effective way to achieve the goal of molecular orientation study at surfaces. However, finding the most effective ways to combine these techniques may not be clear.\\

In order to analyze these vibrational spectra, various factors need to be considered. For example, a molecule's vibrational mode in the molecular frame, the orientation average of the molecules adsorbed onto the surface based on the mathematical orientation distribution function and projecting the vibrational mode properties from molecular frame to laboratory frame. The main focus of my study is combining Linear Programming (LP) with different spectral information to obtain molecular orientation distribution at surfaces. In this thesis, I will explore how LP can facilitate extracting quantitative structural information of molecules at surfaces.\\

My approach is to first study our LP model's properties by applying it to a simplified molecule. After that, the LP model is applied to the representatives of realistic molecules to further explore the possibilities of our LP model. The realistic molecules that I am considering are six amino acids: methionine (Met), leucine (Leu), isoleucine (Ile), alanine (Ala), threonine (Thr) and valine (Val).\\

Before introducing the LP model and the molecule orientation studies, the basic theory of  the IR, Raman and SFG spectra is introduced.\\

\section{Experimental Probes: IR, Raman, SFG Vibrational Spectroscopy}
Vibrational spectra are produced by the changes of a molecule's dipole moment and polarizability. The dipole moment and polarizability are changing as the molecule's conformation is changing. \\

IR is the absorption of passing infrared light through a sample at each frequency, which can be expressed by Equation \ref{eq:1.1}. \\

\begin{equation} \label{eq:1.1}
A_{\rm IR} = - log_{10} \left( \frac{I}{I_{o}} \right)
\end{equation}
where $A_{\rm IR}$ is the measured IR absorbance. $I$ is the light intensity after infrared light pass through the sample. $I_{o}$ is the initial light intensity. \\

The physical principle of IR spectra is the variation of the dipole moment $\mu$ (the first rank tensor) along the normal coordinates $Q$: $\sfrac{\partial\mu}{\partial Q}$. IR spectra can be further expanded by Equation \ref{eq:1.2}.

\begin{equation} \label{eq:1.2}
A_{\rm IR} \approx \left| \frac{1}{\sqrt{2m_{q}w_{q}}} \frac{\partial\mu}{\partial Q} \right|^{2}
\end{equation}
where $m_{q}$ is the reduced mass of the normal mode, and $w_{q}$ is the resonance frequency. The dipole moment $\mu$ is a vector of $x$, $y$ and $z$. The dipole moment derivatives can be expressed as Equation \ref{eq:1.3}. The IR spectra can be obtained from 3 polarizations: $x$, $y$, $z$. \\

\begin{equation} \label{eq:1.3}
\frac{\partial\mu}{\partial Q} = \begin{bmatrix}
									\dfrac{\partial\mu_{x}}{\partial Q} \\
									\dfrac{\partial\mu_{y}}{\partial Q} \\
									\dfrac{\partial\mu_{z}}{\partial Q}
								  \end{bmatrix}
\end{equation}

In the Raman process, stocks-shifted light may be scattered from a molecule sample. Unlike IR, Raman spectra relate to the variation of the molecular polarizability $\alpha$ (the second rank tensor) along the normal coordinates $Q$: $\sfrac{\partial\alpha}{\partial Q}$. \\ 

\begin{equation} \label{eq:1.4}
I_{\rm Raman} \approx \left| \frac{1}{\sqrt{2m_{q}w_{q}}} \frac{\partial\alpha^{(1)}}{\partial Q} \right|^{2}
\end{equation}
where $m_{q}$ and $w_{q}$ are the same as defined in Equation \ref{eq:1.2}. The polarizability is coupled with $x$, $y$, $z$ components of the driving field and $x$, $y$, $z$ components of the induced polarization. Therefore, there are 9 elements in the polarizability, which can be expressed as Equation \ref{eq:1.5}. It results in 9 polarizations of Raman spectra: $xx$, $yy$, $zz$, $xy$, $xz$, $yx$, $yz$, $zy$ and $zx$. \\

\begin{equation} \label{eq:1.5}
\frac{\partial\alpha^{(1)}}{\partial Q} = \begin{bmatrix}
\dfrac{\partial\alpha_{xx}^{(1)}}{\partial Q} & \dfrac{\partial\alpha_{xy}^{(1)}}{\partial Q} & \dfrac{\partial\alpha_{xz}^{(1)}}{\partial Q} \\
\dfrac{\partial\mu_{yx}}{\partial Q} & \dfrac{\partial\alpha_{yy}^{(1)}}{\partial Q} & \dfrac{\partial\alpha_{yz}^{(1)}}{\partial Q}\\
\dfrac{\partial\mu_{zx}}{\partial Q} & \dfrac{\partial\alpha_{zy}^{(1)}}{\partial Q} & \dfrac{\partial\alpha_{zz}^{(1)}}{\partial Q}
\end{bmatrix}
\end{equation}

SFG stands for sum frequency generation vibrational spectroscopy. SFG is a surface-specific technique. It is a non-linear optical process. SFG is the variation of the outer product of dipole moment and polarizability, $\alpha^{(2)}$ (the third rank tensor): $\frac{\partial\mu}{\partial Q} \otimes \frac{\partial\alpha}{\partial Q} $. Therefore, there are 27 elements for SFG spectra, which result in 3 unique polarizations of SFG spectra: $xxz$, $xzx$, and $zzz$. \\

\begin{equation} \label{eq:1.6}
I_{\rm SFG} \approx \left| \alpha^{(2)}_{ijk} \right|^{2}
= \left| \frac{1}{2m_{Q}w_{Q}} \left( \frac{\partial\alpha^{(2)}_{ij}}{\partial Q} \otimes \frac{\partial\mu_{k}}{\partial Q} \right) \right|^{2}
\end{equation}

\section{Linear Programming}
LP problems are optimization ones of a specific form. The standard form of LP is a minimization problem that has an objective function and a number of constraints as shown in Equation \ref{eq:1.7} \cite{UULP}:

\begin{eqnarray}  \label{eq:1.7}
 \text{minimize} & c_{1}x_{1} + c_{2}x_{2} + ... + c_{n} x_{n}  \nonumber \\
 \text{subject to} & a_{11} x_{1} + a_{12} x_{2}+ ... + a_{1n} x_{n} = & b_{1} \nonumber \\
& a_{21} x_{1} + a_{22} x_{2} + ... + a_{2n} x_{n} = & b_{2} \nonumber \\
&\vdots                                   &\vdots \nonumber \\
& a_{m1} x_{1} + a_{m2} x_{2} + ... + a_{mn} x_{n} = & b_{m} \nonumber \\
& x_{1} \geq 0, x_{2} \geq 0, ... ,x_{n} \geq 0, 
\end{eqnarray} 
where $x_{i}$ are the decision variables, $a_{ij}$ is a matrix of known coefficients, $b_{i}$ and $c_{i}$ are vectors of known coefficients. The expression to be minimized is called objective function. The equalities and the inequalities are the constraints that all the decision variables need to subject to. These constraints specify a convex polytope that the objective function need to optimize over. \\ 

The diet problem is a popular example to illustrate the concept of LP. It is described as follows: a restaurant would like to achieve the minimal nutrition requirements with the lowest price over some food selections as shown in Table \ref{tab:1.1}. For each meal, the minimum requirements for vitamin A, vitamin C and dietary fiber are $0.5 \rm mg$, $15 \rm mg$ and $4 \rm g$. The restaurant has three food options: raw carrot, raw white cabbage and pickled cucumber. The table also displays the nutrition content and the price of each ingredient. With all the information, we want to know how much carrot, cabbage and cucumber is needed in each meal, so that the minimal nutrition requirements can be met with the lowest price. In summary, the goal is to minimize the price, and the constraints are the nutrition requirements. Therefore, the following LP model is formulated as shown in Equations from \ref{eq:1.8} to \ref{eq:1.14}.

\begin{table} 
\begin{center}
\begin{tabular}{| l | l  l  l | l |}
\hline
Food & Carrot & Cabbage & Cucumber & Required per dish \\ \hline
Vitamin A [mg/kg] & 35 & 0.5 & 0.5 & 0.5mg \\ 
Vitamin C [mg/kg] & 60 & 300 & 10 & 15mg \\ 
Dietary Fiber [g/kg] & 30 & 20 & 10 & 4g \\ \hline
price[$\$$/kg] & 0.75 & 0.5 & 0.15 & - \\ \hline
\end{tabular} 
\end{center}
\caption{Sample input of the diet problem}
\label{tab:1.1}
\end{table}	

\begin{eqnarray} 
\text{minimize} & 0.75x_{1} + 0.5x_{2} +  0.15x_{3}  \label{eq:1.8} \\
\text{subject to} & 35x_{1} + 0.5x_{2} + 0.5x_{3} \geq 0.5 \label{eq:1.9} \\
& 60x_{1} + 300x_{2} + 10x_{3} \geq 15 \label{eq:1.10} \\
& 30x_{1} + 20x_{2} + 10x_{3} \geq 4 \label{eq:1.11} \\
& x_{1} \geq 0  \label{eq:1.12} \\
& x_{2} \geq 0  \label{eq:1.13} \\
& x_{3} \geq 0  \label{eq:1.14}
\end{eqnarray} 
where $x_{1}$, $x_{2}$ and $x_{3}$ are the decision variables. Each decision variable presents the amount of each ingredient. Equation \ref{eq:1.8} is the objective function to minimize. Equation \ref{eq:1.9} to Equation \ref{eq:1.11} describe the nutrition requirements. Equation \ref{eq:1.12} to Equation \ref{eq:1.14} ensure the amount of each ingredient to be greater than 0. The coefficients in the objective function represent $c_{i}$ vector in Equation \ref{eq:1.1}. The coefficients of the decision variables in Equation \ref{eq:1.9}, \ref{eq:1.10} and \ref{eq:1.11} represent $a_{ij}$ matrix. $b_{i}$ vector is composed by the right-hand side of Equation \ref{eq:1.9}, \ref{eq:1.10} and \ref{eq:1.11}. \\

In order to apply simplex method, the above LP problem needs to transfer into its standard form. The inequalities of Equations from \ref{eq:1.9} to \ref{eq:1.11} need to transform to equalities. Therefore, a new variable, called a slack variable (SV) is introduced to change each inequality to equality \cite{ConvexOptimization}. \\

With the existing LP solvers that implemented simplex method, the optimal solution can be obtained within a second. \\

For a LP problem, there are only three kinds of solutions: feasible and bounded, feasible and unbounded, and infeasible. If the solution space is feasible and bounded, then there is one optimum solution. If it is feasible but unbounded, then there is a solution space with an infinite number of optimal solutions \cite{LP}. \\

A general LP problem can be a minimization or maximization problem. Its constraints can be equalities or inequalities. For each non-standard LP problem, there are ways to convert it into its standard form. Furthermore, for a LP problem that contains $n$ decision variables, its solution would be in a $n$-dimensional space called $R^{n}$. Each constraint is a hyperplane. It divides the $R^{n}$ space into two half-spaces. Therefore, all the constraints together cut this $R^{n}$ space into a convex polyhedron when there are feasible solutions. This makes LP a convex problem. The benefit of a convex problem is that the local optimal solution is the global optimum. LP solvers return the optimal solution. If a LP problem has a unique optimal solution, this solution is a vertex of the convex polyhedron. In other words, LP is a convex, deterministic process. It is guaranteed to converge to a single global optimum if there is a bounded solution space. \\

Another advantage of LP is that it can deal with tens or hundreds of thousands of variables, which makes it suitable for the study of a molecule's orientation distribution at surfaces. Furthermore, LP problems are intrinsically easier to solve than many non-linear problems. \\

Various algorithms are available in solving LP problems, such as: simplex algorithm, interior point, and path-following algorithms. Both interior point and simplex are common and mature algorithms that work well in practice. Simplex is comparatively easier to understand and implement than interior point. Simplex method takes the advantage of the geometric concept that it visits the vertices of the feasible set (convex polyhedron), and checks the optimal solution among each visited vertex. The converging approach is different for these two methods. If there are $n$ decision variables, usually simplex method converges in $O(n)$ operations with $O(n)$ pivots. Interior point traverses the edges between vertices on a polyhedral set. Generally speaking, Interior point method is faster for larger problems with sparse matrix. However, when experimenting with these two methods, the speed of them is not much different from each other for my study. In my study, simplex method has proved to be efficient and effective, and it is used for all the test cases. \\

Last but not the least advantage of LP is its speed. For any LP problem, if it has an optimal solution, this solution is always a vertex. Simplex method is based on this insight, namely that it starts at a vertex, then pivot from vertex to vertex, until it reaches the optimum. Although it has been shown that simplex method is not a polynomial algorithm, in practice it usually takes $2n\sim3n$ steps to solve a problem ($n$ is the number of the decision variables). Currently there are two main approaches in studying the orientation distribution of molecules at surface. One is comparing the experimental spectra with few predicted ones, and select the one that most matches to the experimental one. Another one is running an exhaustive algorithm to explore the most possible solution space \cite{hore0033-rotations}. However, both approaches take a lot of time and computational resources. Therefore, applying LP will result a large gain in computation.\\

The LP solver we use is called ``GNU linear programming tool kit" (GLPK). It has implemented both simplex and interior point methods in C programming language. It is open-source and intended to solve large scale LP problems. \\

\section{Conclusion and Open Questions from Previous Study}
%In Hung's study \cite{KuoKaiHung:Thesis:2015}, the new approach of applying LP to vibrational spectra to extract the molecular orientation distribution at surfaces is introduced. The LP approach helped to return the target orientation distribution information when the mock experimental spectrum consisted of different amino acids. However, when candidates are coming from the same amino acid, LP approach failed to return the target orientation distribution information. The reason why LP failed to return the target composition has not been thoroughly studied in Hung's study. Whether and how LP approach can be generally applied to different case studies have not been explored neither. Moreover, in Hung's study, only SFG spectral information is applied to the LP model. The case of combining different spectral techniques to the LP model was not considered. Only mock experimental spectral information is considered.

My research is based on Hung's study \cite{KuoKaiHung:Thesis:2015}. In his study, he mentioned that generating model spectra that match the target experimental spectra from a list of known candidates is a way to extract molecular orientation information at surface. The traditionally exhaustive way of achieving this goal consumes too much computational effort, therefore, he introduced LP approach to vibrational spectroscopy study. The LP approach results in pseudo polynomial time $O(n)$, which is a great improvement compared to $O(n!)$. \\

However, depends on different test case settings, the LP approach may not always return the target composition of candidates that generates the mock target experimental spectra. When considering the candidates from one type of molecule at surfaces, the return solution of the LP approach does not match the known target composition. When considering the candidates from a mixture of molecules, the return solution of the LP approach does match the know target composition. The reason why the LP approach failed to return the target composition has not been thoroughly studied by Hung. \\

Moreover, when applying the LP approach, only SFG spectral information has been considered in his LP model. The possibility and applicability of using IR and Raman spectral information to the LP approach have not been considered. Meanwhile, the possibility of combining different spectral information to the LP approach has not been considered neither. \\
	
\section{Aims and Scope}
The goal of my study is to figure out the underlying properties of the LP approach, figure out what is the cause that the LP approach fails to obtain the target composition of candidates in some test cases. Based on the gained information, I further explore the applicability of the LP approach to different test cases. My plan is applying the LP approach to a simplified molecular model first, so that only the properties of our LP model can be focused. \\

With the properties learnt from the first step, the LP approach is then applied to realistic molecules. There are two types of test cases, one is considering the candidates coming from one type of realistic molecule, to see if the LP approach can return the target composition of the mock spectra. Another one is considering the candidates coming from different types of realistic molecules. If the LP approach achieve in obtaining the target composition, then how the LP approach applied systematically will be studied. \\

The purpose is to check if LP approach will return the target composition of the spectra for one type of molecule at surfaces. If yes, whether the LP model can be applied generally to one type molecule will be studied. If not, what is the underlie reason will be explored. Similar study will also be applied to different molecules at surfaces. At last, the experimental spectral information is brought into consideration. \\

\section{Overview of the Thesis}
Chapter \ref{ch:1} briefly introduces the aim and scope of the current study. Chapter \ref{ch:2} explains the current approaches to extract the molecular orientation distribution at surfaces, as well as how to produce IR, Raman and SFG spectra. Chapter \ref{ch:3} aims to use a simplified molecular model to study the properties of our LP model. Chapter \ref{ch:4} applies our LP approach to one type of molecule at surfaces. Chapter \ref{ch:5} applies the LP approach to a mixture of different molecules at surfaces. Chapter \ref{ch:6} applies the LP approach to experimental spectral data. Chapter \ref{ch:7} is the conclusion and future work.
